{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\dpisarev\\\\IdeaProjects\\\\FullStack-Apparel-Store-Springboot-React\\\\frontend\\\\src\\\\components\\\\CheckoutPage.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport Checkout_ITEM from \"./CheckoutItem\";\nimport { Row, Col } from \"antd\";\nimport { useHistory } from \"react-router-dom\";\nimport { useRecoilState } from \"recoil\";\nimport { cartState, authState } from \"../states/atoms\";\nimport putNotification from \"./Notification\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CheckoutPage = () => {\n  _s();\n  const history = useHistory();\n  const [isAuth, setIsAuth] = useRecoilState(authState);\n  const [items, setItems] = useRecoilState(cartState);\n  const [contents, setContents] = React.useState([]);\n  React.useEffect(() => {\n    console.log(\"hello from checkout\", items);\n    const deals = items.map(d => /*#__PURE__*/_jsxDEV(Checkout_ITEM, {\n      deal: d\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 37\n    }, this));\n    setContents(deals);\n  }, []);\n  const checkout = async () => {\n    if (items.length === 0) {\n      putNotification(\"Nothing in cart\", \"Add item to you cart dear!!\");\n      return;\n    }\n    if (!isAuth) {\n      putNotification(\"Redirecting\", \"Sire you need to login first\");\n      history.push(\"/login\");\n      return;\n    }\n    const data = items.map(d => {\n      return {\n        \"id\": d.id,\n        \"num\": d.quantity\n      };\n    });\n    const token = localStorage.getItem(\"token\");\n    try {\n      const route = \"https://localhost:8443/api/v1/cart/all\";\n      const resp = await axios.post(route, data, {\n        // mode: \"no-cors\",\n        // withCredentials:true,\n        // credentials: 'include',\n        headers: {\n          Authorization: token\n        }\n      });\n      if (resp.status === 200) {\n        putNotification(\"Success\", \"Your order has been successfully processed\");\n        setContents([]);\n        setItems([]);\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.log(error.response);\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.status) === 403) {\n        putNotification(\"session expired\", \"please relogin\");\n        localStorage.removeItem(\"token\");\n        setIsAuth(false);\n      } else {\n        var _error$response2, _error$response2$data;\n        putNotification(\"Error Occured\", (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"jumbotron\",\n    style: {\n      backgroundColor: \"whitesmoke\",\n      minHeight: \"100vh\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Row, {\n      style: {\n        fontFamily: \"'Open Sans Condensed', sans-serif\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        span: 20,\n        children: [\"   \", /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"display-4\",\n          children: \"Cart\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 33\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 14\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        span: 4,\n        style: {\n          paddingTop: 50\n        },\n        children: [\"   \", /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ant-btn ant-btn-danger ant-btn-lg\",\n          onClick: checkout,\n          children: \"Checkout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 56\n        }, this), \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 14\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      style: {\n        padding: 5,\n        fontSize: \"18px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        span: 6,\n        children: \" Product \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        span: 10,\n        children: \"Product Name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        span: 4,\n        children: \" Quantity  \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        span: 4,\n        children: \" Total Value \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this), contents]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 9\n  }, this);\n};\n_s(CheckoutPage, \"9i2ck2Sg6ME1gtXTNLbvj+vyU3A=\", false, function () {\n  return [useHistory, useRecoilState, useRecoilState];\n});\n_c = CheckoutPage;\nexport default CheckoutPage;\nvar _c;\n$RefreshReg$(_c, \"CheckoutPage\");","map":{"version":3,"names":["React","Checkout_ITEM","Row","Col","useHistory","useRecoilState","cartState","authState","putNotification","axios","jsxDEV","_jsxDEV","CheckoutPage","_s","history","isAuth","setIsAuth","items","setItems","contents","setContents","useState","useEffect","console","log","deals","map","d","deal","fileName","_jsxFileName","lineNumber","columnNumber","checkout","length","push","data","id","quantity","token","localStorage","getItem","route","resp","post","headers","Authorization","status","error","_error$response","_error$response$data","response","removeItem","_error$response2","_error$response2$data","message","className","style","backgroundColor","minHeight","children","fontFamily","span","paddingTop","onClick","padding","fontSize","_c","$RefreshReg$"],"sources":["C:/Users/dpisarev/IdeaProjects/FullStack-Apparel-Store-Springboot-React/frontend/src/components/CheckoutPage.js"],"sourcesContent":["import React from 'react'\r\nimport Checkout_ITEM from \"./CheckoutItem\"\r\nimport {Row, Col} from \"antd\"\r\nimport {useHistory} from \"react-router-dom\"\r\nimport {useRecoilState} from \"recoil\"\r\nimport {cartState, authState} from \"../states/atoms\"\r\nimport putNotification from \"./Notification\"\r\nimport axios from \"axios\"\r\n\r\nconst CheckoutPage = () => {\r\n    const history = useHistory()\r\n    const [isAuth, setIsAuth] = useRecoilState(authState)\r\n    const [items, setItems] = useRecoilState(cartState)\r\n    const [contents, setContents] = React.useState([])\r\n\r\n    React.useEffect(()=>{\r\n        console.log(\"hello from checkout\", items)\r\n        const deals = items.map(d =><Checkout_ITEM deal={d} />)\r\n        setContents(deals)\r\n    },[])\r\n\r\n    const checkout = async()=>{\r\n        if(items.length === 0) {\r\n            putNotification(\"Nothing in cart\", \"Add item to you cart dear!!\")\r\n            return\r\n        }\r\n        if(!isAuth){\r\n            putNotification(\"Redirecting\", \"Sire you need to login first\")\r\n            history.push(\"/login\")\r\n            return\r\n        }\r\n        const data = items.map(d => {\r\n            return {\r\n                \"id\" : d.id, \r\n                \"num\":d.quantity\r\n            }})\r\n\r\n        const token = localStorage.getItem(\"token\")\r\n        try {\r\n            const route = \"https://localhost:8443/api/v1/cart/all\"\r\n            const resp = await axios.post(route, data, {\r\n                // mode: \"no-cors\",\r\n                // withCredentials:true,\r\n                // credentials: 'include',\r\n                headers: {\r\n                    Authorization: token\r\n                }\r\n            });\r\n            if(resp.status === 200){\r\n                putNotification(\"Success\", \"Your order has been successfully processed\")\r\n                setContents([])\r\n                setItems([])\r\n            }\r\n        } catch (error) {\r\n            console.log(error.response)\r\n            if(error.response?.data?.status === 403){\r\n                putNotification(\"session expired\", \"please relogin\")\r\n                \r\n                localStorage.removeItem(\"token\")\r\n                setIsAuth(false)\r\n            }else{\r\n                putNotification(\"Error Occured\", error.response?.data?.message)\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    return (\r\n        <div className=\"jumbotron\" style={{backgroundColor:\"whitesmoke\", minHeight:\"100vh\"}}>\r\n            <Row style={{fontFamily: \"'Open Sans Condensed', sans-serif\"}}>\r\n             <Col span={20} >   <h1 className=\"display-4\">Cart</h1></Col>\r\n             <Col span={4} style={{paddingTop:50}} >   <button className=\"ant-btn ant-btn-danger ant-btn-lg\" onClick={checkout} >Checkout</button> </Col>\r\n            </Row>\r\n            <Row style={{ padding: 5, fontSize: \"18px\" }}>\r\n                <Col span={6}> Product </Col>\r\n                <Col span={10}>Product Name</Col>\r\n                <Col span={4}> Quantity  </Col>\r\n                <Col span={4}> Total Value </Col>\r\n            </Row>\r\n            {\r\n                contents\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default CheckoutPage\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}